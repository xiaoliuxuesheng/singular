# 第一章 Redis概述

## 1.1 Redis支持的数据类型

1. String字符串 : 是Redis最基本的数据类型，一个键最大能存储512MB
2. Hash（哈希）: 是一个string类型的field和value的映射表
3. List（列表）: 列表是简单的字符串列表，按照插入顺序排序
4. Set（集合）: 是string类型的无序集合
5. zset(sorted set：有序集合) : 是string类型元素的集合,且不允许重复的成员。

## 1.2  Redis持久化

1. Redis 提供了两种持久化方式:RDB（默认） 和AOF
    - RDB(Redis DataBase) : 功能核心函数rdbSave(生成RDB文件)和rdbLoad（从文件加载内存）两个函数
    - AOF(Append-only file) : WRITE：根据条件，将 aof_buf 中的缓存写入到 AOF 文件；SAVE：根据条件，调用 fsync 或 fdatasync 函数，将 AOF 文件保存到磁盘中。
2. Redis两种持久化的特点
    - aof文件比rdb更新频率高，优先使用aof还原数据
    - aof比rdb更安全也更大
    - rdb性能比aof好
    - 如果两个都配了优先加载AOF

## 1.3 Redis架构模式

1. **单机版** ： 使用简单、内存容量有限 、处理能力有限 、无法高可用
2. **主从复制** ：根据一个 Redis 服务器来创建任意多个该服务器的复制品，其中被复制的服务器为主服务器（master），而通过复制创建出来的服务器复制品则为从服务器（slave）
    - 只要主从服务器之间的网络连接正常，主从服务器两者会具有相同的数据，主服务器就会一直将发生在自己身上的数据更新同步 给从服务器，从而一直保证主从服务器的数据相同。
    - 无法保证高可用，没有解决 master 写的压力
3. **哨兵**：Redis sentinel 是一个分布式系统中监控 redis 主从服务器，并在主服务器下线时自动进行故障转移
    - 保证高可用、监控各个节点、自动故障迁移；
    - 缺点：主从模式，切换需要时间丢数据；没有解决 master 写的压力
4. **集群（proxy 型）**：Twemproxy 是一个 Twitter 开源的一个 redis 和 memcache 快速/轻量级代理服务器
    - 缺点：增加了新的 proxy，需要维护其高可用。failover 逻辑需要自己实现，其本身不能支持故障的自动转移可扩展性差，进行扩缩容都需要手动干预
5. **集群（直连型）**：从redis 3.0之后版本支持redis-cluster集群，Redis-Cluster采用无中心结构，每个节点保存数据和整个集群状态,每个节点都和其他所有节点连接
    - 资源隔离性较差，容易出现相互影响的情况。数据通过异步复制,不保证数据的强一致性

## 1.4 缓存穿透

- **概念：** 一般的缓存系统，都是按照key去缓存查询，如果不存在对应的value，就应该去后端系统查找（比如DB）。一些恶意的请求会故意查询不存在的key,请求量很大，就会对后端系统造成很大的压力。这就叫做缓存穿透
- **解决方案：** 

