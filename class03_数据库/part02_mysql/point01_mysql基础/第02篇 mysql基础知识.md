# 第3章 mysql数据类型与运算

## 3.1 mysql存储引擎

> - 存储引擎是数据库底层软件组件，MySQL中数据可以用各种不同的技术存储在文件或内存中；
> - 不同的存储引擎提供不同的存储机制、索引技巧、锁定水平等功能；
> - 不同的存储引擎，有其特定的功能。

:dash: ​ 查看MySQL支持的存储引擎

```sql
show engines
```

1. <font size=5>**InnoDB存储引擎**</font>

    - InnoDB是为处理巨大数据量的最大性能设计，灾难的恢复性比较好；

    - 是事务型数据库的首选引擎，支持行级锁，具有更高的并发性能，默认的隔离级别是可重复读；

    - InnoDB存储引擎完全与MySQL服务器整合，在主内存中缓存数据和索引而维持在自己的缓冲池；

    - InnoDB将他的表和索引存在一个逻辑表空间中；

        > 所有数据会安装主键来组织（所以UUID本质是不推荐使用）
        >
        > 数据可索引房子一起，位于B+树的叶子节点上。

    - InnoDB支持外键完整性约束。

2. <font size=5>**MyISAM存储引擎**</font>

    - 在支持大文件的文件系统和操作系统上被支持

3. <font size=5>**MEMORY存储引擎**</font>

## 3.2 mysql数据类型

1. <font size=5>整数类型</font>

    :anchor: **特点**

    - 主要用来存储整数数字；
    - 不同的整数类型提供不同的取值范围和存储空间；

    :anchor: **整数类型说明**

    | 类型           | 大小  | 范围-有符号                          | 默认宽度 | 作用       |
    | -------------- | ----- | ------------------------------------ | -------- | ---------- |
    | tinyint        | 1字节 | -2<sup>7</sup>-1 ~ 2<sup>7</sup>-1   | 4        | 最小整数值 |
    | smallint       | 2字节 | -2<sup>15</sup>-1 ~ 2<sup>15</sup>-1 | 6        | 小整数值   |
    | mediumint      | 3字节 | -2<sup>23</sup>-1 ~ 2<sup>23</sup>-1 | 9        | 中整数值   |
    | int \| integer | 4字节 | -2<sup>31</sup>-1 ~ 2<sup>31</sup>-1 | 11       | 普通整数值 |
    | bigint         | 8字节 | -2<sup>63</sup>-1 ~ 2<sup>63</sup>-1 | 20       | 大整数值   |

    :one: **整数类型(n)** :  不代表占用空间容量。而代表最小显示位数 

    - 整数型的数值类型已经限制了取值范围，有符号整型和无符号整型都有，而M值并不代表可以存储的数值字符长度，它代表的是数据在显示时显示的最小长度；
    - 当存储的字符长度超过M值时，没有任何的影响，只要不超过数值类型限制的范围；
    - 当存储的字符长度小于M值时，只有在设置了zerofill用0来填充，才能够看到效果，换句话就是说，没有zerofill，M值就是无用的。

2. <font size=5>浮点数类型和定点数类型</font>

    :anchor: **特点**

    - 主要用来存储小数数字；
    - 主要包含单精度浮点数、双精度浮点数、定点浮点数；

    :anchor: **小数类型说明**

    | 类型           | 大小         | 范围-有符号    | 默认宽度 | 作用         |
    | -------------- | ------------ | -------------- | -------- | ------------ |
    | float          | 4字节        |                |          | 单精度浮点值 |
    | double         | 8字节        |                |          | 双精度浮点值 |
    | decimal（M,D） | M \| D+2字节 | 依赖于M或D的值 | （10,0） | 小数值       |

    :one: **整数类型(m,d)**  : float与double在插入值发生截取时候不会有四舍五入警告,decimal会产生截断警告，不会四舍五入。

3. <font size=5>日期时间类型</font>

    :anchor: **特点**

    - MySQL有多重日期的数据类型
    - 每一个类型都有合法的取值范围

    :anchor: **日期时间类型**

    | 类型      | 日期格式            | 日期范围                                | 存储大小 |
    | --------- | ------------------- | --------------------------------------- | -------- |
    | year      | YYYY                | 1901~2155                               | 1字节    |
    | time      | HH:MM:SS            | -838:59:59~838:59:59                    | 3字节    |
    | date      | YYYY-MM-DD          | 1000-01-01~9999-12-03                   | 3字节    |
    | datetime  | YYYY-MM-DD HH:MM:SS | 1000-01-01 00:00:00~9999-12-03 23:59:59 | 8字节    |
    | timestamp | YYYY-MM-DD HH:MM:SS | 1970-01-01 00:00:01~2038-01-19 03:14:07 | 4字节    |

    :one: 

4. <font size=5>文本字符串类型</font>

    :anchor: 特征

    - 字符串类型用来存储字符串数据，还可以存储其他数据：比如图片和声音等二进制数据
    - 文本字符可以进行区分或者不区分大小写的字符比较
    - 文本字符串可以进行模式匹配查找

    :anchor: MySQL中的文本字符串类型

    | 字符类型   | 说明                             | 存储                          |
    | ---------- | -------------------------------- | ----------------------------- |
    | char(M)    | 固定长度非二进制字符串           | M字节 : M<=255                |
    | varchar(M) | 变长非二进制字符串               | L+1字节 : L <= M              |
    | tinytext   | **非常小**的非二进制字符串       | L+1字节 : L <= 2<sup>8</sup>  |
    | text       | **小** 非二进制字符串            | L+2字节 : L <= 2<sup>16</sup> |
    | mediutext  | **中** 非二进制字符串            | L+3字节 : L <= 2<sup>24</sup> |
    | longtext   | **大** 非二进制字符串            | L+4字节 : L <= 2<sup>32</sup> |
    | enum       | 枚举:只能由一个枚举字符串        | 取决于枚举值的数量:最大65535  |
    | set        | 字符串对象可以有0个或多个set成员 | 最多64个成员                  |

    :one: 

5. <font size=5>二进制字符串类型</font>

    :anchor: 特征

    - 在数据库中存储的是二进制数据的数据类型。
    - **实际编码中，使用二进制类型并不多，就当了解一下好了**

    :anchor: MySQL中的二进制字符串类型

    | 类型名称      | 说明                   |
    | ------------- | ---------------------- |
    | bit(M)        | 位字段类型             |
    | binary(M)     | 固定长度的二进制字符串 |
    | varbinary(M)  | 可变长度的二进制字符串 |
    | tinyblob(M)   | 非常小的blob           |
    | blob(M)       | 小的blob               |
    | mediumblob(M) | 中等大小的blob         |
    | longblob(M)   | 非常大的blob           |

    > blob类型是一种特殊的二进制类型。
    >
    > blob可以用来保存数据量很大的二进制数据
    >
    > blob类型与text类型很类似，不同点在于blob类型用于存储二进制数据，blob类型数据是根据其二进制编码进行比较和排序的，而text类型是文本模式进行比较和排序的

## 3.3 mysql运算符

1. <font size=5>算符运算符</font>

    | 运算符 | 作用              |
    | ------ | ----------------- |
    | +      | 加法运算          |
    | -      | 减法运算          |
    | *      | 乘法运算          |
    | /      | 除法运算:返回商   |
    | %      | 求余运算:返回余数 |

2. <font size=5>比较运算符</font>

    | 运算符         | 作用                                    |
    | -------------- | --------------------------------------- |
    | =              | 等于                                    |
    | <=>            | 安全的等于                              |
    | <>   或者   != | 不等于                                  |
    | <=             | 小于等于                                |
    | <              | 小于                                    |
    | \>=            | 大于等于                                |
    | >              | 大于                                    |
    | is null        | 判断一个值是否为NULL                    |
    | is not null    | 判断一个值是否不为NULL                  |
    | least          | 在有两个或多个参数时候返回最小值        |
    | between and    | 判断一个值是否在两个值中间              |
    | isnull         | 判断一个值是否为NULL:与is null 效果一样 |
    | in             | 判断一个值是否在in列表中的任意一个值    |
    | not in         | 判断一个值是否不在in列表中的任意一个值  |
    | like           | 通配符匹配                              |
    | regexp         | 正则表达式匹配                          |

3. <font size=5>逻辑运算符</font>

    | 运算符        | 作用     |
    | ------------- | -------- |
    | not  或者  !  | 逻辑非   |
    | and  或者 &&  | 逻辑与   |
    | or  或者 \|\| | 逻辑或   |
    | xor           | 逻辑异或 |

4. <font size=5>位操作运算符</font>

    | 运算符 | 作用   |
    | ------ | ------ |
    | \|     | 位或   |
    | &      | 位与   |
    | ^      | 为异或 |
    | <<     | 位左移 |
    | \>>    | 位右移 |
    | ~      | 位取反 |

5. <font size=5>运算符优先级</font>

    | 运算符优先级 - 从低到高                                      |
    | ------------------------------------------------------------ |
    | = (赋值运算)                                                 |
    | \|\|，or                                                     |
    | xor                                                          |
    | && ，and                                                     |
    | not                                                          |
    | between，case，when，then，else                              |
    | =(比较运算)，<==>，>=，>，<=，<，<>，!=，is，like，regexp，in |
    | \|                                                           |
    | &                                                            |
    | <<，>>                                                       |
    | -，+                                                         |
    | *，/，%                                                      |
    | ^                                                            |
    | -(符号)，~(位反转)                                           |
    | ！                                                           |

# 第4章 mysql函数

## 4.1 数字函数

:anchor: 常用的数字函数

| 函数名        | 作用                                           |
| ------------- | ---------------------------------------------- |
| abs(x)        | 计算数值x的绝对值                              |
| pi()          | 计算圆周率π的值                                |
| sqrt(x)       | 计算数值x的平方根,负数没有平方根               |
| mod(x,y)      | 计算x被y除后的精确余数,对小数有效              |
| ceil(x)       | 返回不小于x的最小整数                          |
| ceiling(x)    | 返回不小于x的最小整数                          |
| floor(x)      | 计算不大于数值x的最大整数值,返回值转换为bigint |
| rand()        | 返回一个0到1之间的随机浮点值                   |
| rand(x)       | 基于一个基数x的固定的0到1之间的浮点值          |
| round(x)      | 将数值x四舍五入为一个整数                      |
| round(x,y)    | 数值x四舍五入保留y为小数                       |
| truncate(x,y) | 数值x截取保留y为小数                           |
| sign(x)       | 返回数值x的符号                                |
| pow(x,y)      | 返回x的y次乘方的结果值                         |
| power(x,y)    | 返回x的y次乘方的结果值                         |
| exp(x)        | 返回以e为底的x次方                             |

## 4.2 字符串函数

:anchor: 常用的字符串函数

| 函数名 | 作用 |
| ------ | ---- |
|        |      |

## 4.3 日期时间函数

:anchor: 常用的日期时间函数

| 函数名 | 作用 |
| ------ | ---- |
|        |      |

## 4.4 条件判断函数

:anchor: 常用的条件判断函数

| 函数名 | 作用 |
| ------ | ---- |
|        |      |

## 4.5 系统函数

:anchor: 常用的系统函数

| 函数名 | 作用 |
| ------ | ---- |
|        |      |

## 4.6 加解密函数

:anchor: 常用的加解密函数

| 函数名 | 作用 |
| ------ | ---- |
|        |      |

## 4.7 其他函数

:anchor: 常用的其他函数

| 函数名                                                       | 作用                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| format(x,n)                                                  | 将数字x格式化,并四舍五入的方式保留小数点后n位,将结果以字符串的形式返回 |
| conv(N,from,to)                                              | 不同进制间的转换,返回N的字符串表示                           |
| inet_aton(ip)<br />inet_ntoa(num)<br />inet6_aton(ip)<br />inet6_ntoa(0x..) | 网络地址IP与数值的转换函数                                   |
| get_lock(str,time)<br />release_lock(str)                    |                                                              |
| benchmark(count,expe)                                        | 重复count次执行表达式expr,用于计算mysql处理表达式的速度,0表示处理很快 |
| convert(···using···)                                         | 改变字符集函数                                               |
| cast(x AS type)<br />convert(x,type)                         | 将一个类型的值转为另一个类型的值<br />   可以转换的值:binary char date time datetime decimal signed unsigned |

- 代码练习

    ```sql
    select format(1234123.23412,4),format(0,4),format(12.123,0);
    
    select conv(5,10,2),conv(16,8,16);
    
    select inet_aton('192.168.57.129'),inet_ntoa(3232250241);
    select inet6_aton('192.168.57.129'),inet6_ntoa(0xC0A83981);
    
    select password('root');
    select benchmark(5000, password('root'));
    
    select charset('String'),convert('String' using utf8),convert('String' using latin1);
    
    select cast('a' as binary),convert('a' , binary );
    ```

    

# 第五章 数据库和数据表

## 5.1 数据库

1. 查看数据库：MySQL安装完毕后，会在data目录下创建MySQL服务必备数据库，使用命令可以查看

   ```shl
   show databases;
   ```

2. 操作数据库

   - 创建数据库：如果数据库已存在则会建库语句会抛出异常；

     ```sql
     create database 数据库名称;
     ```

   - 创建数据库并判断是否存在：如果存在则忽略创建语句，如果不存在才创建数据库；

     ```sql
     create database if not exists 数据库名称;
     ```

   - 使用数据库

     ```sql
     use 数据库名称;
     ```

   - 查看当前使用的数据库的数据表

     ```sql
     show tables;
     ```

3. 删除数据库

   ```sql
   drop database 数据库名称;
   ```

## 5.2 数据表

### 1. 创建数据库

```sql
create table tb_example(
	id int [unsigned] [列约束] comment '主键id',
	name varchar(255) [列约束] comment '应用名',
	[表约束]
)engine=innodb default charset=utf8mb4 comment '这是一张示例表';
```

> 1. 表和表中字段要加commet注释；
> 2. 整数类型的数据可以根据实际应用添加无符号约束：unsigned；

### 2. 数据库约束

### 3. 查看数据表结构

### 4. 修改数据库

### 5. 删除数据库

# 第六章 数据操作语句

