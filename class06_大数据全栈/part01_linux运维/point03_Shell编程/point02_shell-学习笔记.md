# 前言

## 1. 小数点在Linux的场景

- 单独使用点（.）表示source命令，可用来刷新系统变量文件
- 在斜杠之前表示相对路径（./）
- 在文件名称之前表示是隐藏文件（.filename）

## 2. Linux命令echo

- 格式：<kbd>echo [选项] "输出内容"</kbd>

  - 如果输出内容没有特殊内容，可以不适用双引号。

- 常用选项说明

  - **-e** : 支持反斜杠线控制的字符转换

    | 控制字符 | 作用               |
    | -------- | ------------------ |
    | `\\`     | 输出`\`本身        |
    | `\a`     | 输出警告音         |
    | `\b`     | 退格键(字符删除键) |
    | `\c`     | 取消行末的换行符   |
    | `\e`     | ESC键              |
    | `\f`     | 换页符             |
    | `\n`     | 换行符             |
    | `\r`     | 回车键             |
    | `\t`     | 制表符             |
    | `\Onnn`  | 输出八进制字符     |
    | `\Xnn`   | 输出十六进制字符   |

  - **-n : **输出内容后不换行

- echo输出颜色

  ```sh
  # 修改文字颜色
  echo -e "\e[1;颜色 被修改的字符\e[0m"
  
  
  ```

  > - 固定开头格式`\e[1;`  - 表示颜色开始的
  > - 固定结尾格式`\e[0m` - 表示颜色的结束
  > - 文字颜色：30m=黑、31m=红、32m=绿、33m=黄、34m=蓝、35m=洋、36m=青，37m=白色
  > - 背景颜色：40m=黑、41m=红、42m=绿、43m=黄、44m=蓝、45m=洋、46m=青，47m=白色

## 3. Linux命令history

- 格式：<kbd>history</kbd>
  - 历史命令记录是保存在家目录中：`~/.bash_history`文件中；
  - 历史记录文件中会保存本地登录后的历史记录，本次登录后的操作记录是保存在内存中，默认是在用户注销后系统自动将历史记录写入到历史记录文件中；
  - 设置历史记录保持数量：环境变量配置文件`/etc/profile`文件的HISTORY属性，推荐设置大一点；
  
- 常用选项及操作

  | 选项     | 作用                                     |
  | -------- | ---------------------------------------- |
  | `-w`     | 动刷新内存，将内存历史操作记录写入到文件 |
  | `-c`     | 清空历史记录                             |
  | 上下箭头 | 调用历史记录命令                         |
  | ! 编码   | 重复执行第n条历史记录                    |
  | !!       | 重复执行上次记录                         |
  | !字符串  | 重复执行最后一条以指定字符串开头的命令   |
  | !$       | 重复上一条命令的最后一个参数             |

## 4. 别名

- 格式

  - 设置别名 : 修改`~/.bashrc`文件可以永久生效

    ```sh
    alias 命令='别名'
    ```

    > 需要刷新该配置文件才可以生效

  - 查询别名 : alias

- 命令的执行顺序

  - 第一顺位 : 使用路径执行的命令
  - 第二顺位 : 别名
  - 第三顺位 : 执行bash内部命令
  - 第四顺位 : 安装PATH环境变量定义的目录查询到的第一个命令

## 5. 输入输出重定向



# 第一章 Shell基础

## 1.1 什么是shell

- Shell是一个命令解释器：解释执行操作系统应用提供的指令
- Shell脚本是使用基本语法调用系统指令编写的程序化的文本文件
- Shell可以交互的接收用户输入指令，完成系统应用的执行
- Shell的学习重点是对应用程序指令的了解与掌握

## 1.2 Shell脚本解释器的种类

> 查看Linux系统中shell解释器种类：`cat /etc/shells`

1. /bin/sh：最早在Unix中使用，现在几乎被淘汰
2. /bin/bash ：Linux系统中推荐使用的
3. /sbin/nologin：
4. /bin/dash：
5. /bin/tcsh：
6. /bin/csh：现在的Unix的主流解释器

## 1.3 shell脚本与执行方式

1. shell文件 ：推荐使用`.sh`结尾，风格统一便于开发人员识别与维护

   ```sh
   #!/bin/bash
   ```

   > shell脚本文件中第一行的`#!`不是注释内容，作用是bash bang，用于标识以下内容是shell程序，告诉系统使用`/bin/bash`程序解释这个文本

2. shell脚本的执行方式

   ```sh
   # 推荐方式一 : 赋予执行权限,直接调用绝对路径或相对路径执行
   chmod 755 xxx.sh
   ./xxx.sh
   
   # 方式二 : 使用bash命令调用脚本,脚本可以不使用执行权限
   bash xxx.sh
   ```

## 1.4 bash命令行常用快捷键

| 快捷键   | 作用                 |
| -------- | -------------------- |
| Ctrl + A | 把光标移到到命令开头 |
| Ctrl + E | 把光标移动到命令结尾 |
| Ctrl + C | 终止当前命令         |
| Ctrl + L | 清屏                 |
| Ctrl + U | 剪切光标之前的命令   |
| Ctrl + K | 剪切光标之后的命令   |
| Ctrl + R | 在历史命令中搜素     |

# 第二章 Shell语法基础

## 2.1 变量和运算符

### :anchor: 变量的规则

- 命名只能使用英文字母，数字和下划线，首个字符不能以数字开头；
- 中间不能有空格，可以使用下划线（_）；
- 不能使用标点符号；
- 不能使用bash里的关键字（可用help命令查看保留关键字）；
- 变量的赋值号（=）两边不可以有空格，空格在shell命令中有特殊含义；
- 变量的叠加，变量默认是字符串，如果需要数值运算，则需要将变量指定为数值类型；
- 变量的值如果有特殊符号需要用引号；
- 变量叠加默认是字符串拼接。

### :anchor: 变量的类型

- 局部变量（用户自定义）：局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。
- 环境变量（体统变量）：所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。
- 位置参数变量：是预定义变量的一种，给shell脚本定义的自定义参数的变量，名称和作用不可变，内容可以修改
- 预定义变量：在shell脚本中提前定义好的变量，由参数或输入绝对变量的值

### :anchor: 用户自定义变量

> 只在当前shell中生效

1. 定义变量

   ```sh
   变量名=变量值
   ```

2. 修改变量

   ```sh
   变量名=新值
   ```

3. 调用变量

   ```sh
   $变量名
   ```

4. 查看变量

   ```sh
   set [选项]   # 查看系统中所有变量
   ```

   - 选项：-u - 设置变量，如果定义了该设置，调用不存在变量会报错，否则输出为空字符串

   ```sh
   env 		# 查看所有坏境变量,看不到用户自定义变量
   ```

5. 删除变量

   ```sh
   unset 变量名
   ```

### :anchor: 环境变量

> 可以在当前shell或子shell中有效

1. 定义环境变量：关键字export

   ```sh
   export 变量名=值
   ```

   > 是临时生效，系统重启后不存在

2. 查询环境变量

   ```sh
   set		# 查看系统中所有变量
   evn		# 看所有坏境变量,看不到用户自定义变量
   ```

3. 删除变量

   ```sh
   unset 变量名
   ```

4. 新增命令地址到环境变量: /etc/profile

   ```sh
   PATH=@PATH:新地址
   ```

### :anchor: 位置参数变量

1. <kbd>$n</kbd> : n 是数字,表示shell命令以及相关的参数

   ```sh
   n=0 表示命令本身
   n=1-9 表示shell后的第1到9个参数
   如果n大于10,此时使用${10+},要用大括号
   ```

2. <kbd>$*</kbd> : 代表命令行中的所有参数，所有参数会被看做是一个整体

3. <kbd>$@</kbd> : 代表命令行中的所有参数，所有参数会被看做是一个集合

4. <kbd>$#</kbd> : 代表命令行中参数的个数

### :anchor: 预定义变量

1. <kbd>$?</kbd> : 上一条命令的返回状态，如果返回值为0表示执行成功，返回其他有开发自定义表示执行异常
2. <kbd>$\$</kbd> : 获取当前进程ID号
3. <kbd>$!</kbd> : 后台进程中最后一个进程ID号

### :anchor: read接收用户输入

```sh
read [选项] 变量参数(将用户输入值保存到这个变量中)
```

- 选项 : -t 表示等待用户输入的间隔时间
- 选项 : -p 表示输入的提示字符串
- 选项 : -n 表示限制用户输入的字符串字符数
- 选项 : -s 表示隐藏本次用户输入的值

## 2.2 shell中的运算

:anchor: 数值运算的三种方式

1. declare声明变量类型

   ```sh
   declare [+\-] [选项] 变量
   ```

   - 修改类型
     - `+` 表示取消该变量的指定类型
     - `-` 表示为该变量赋予了类型
   - 类型选项
     - -a 表示数组
     - -i 表示数值
     - -r 声明变量为只读变量
     - -x 声明变量为环境变量
     - -p 显示该变量被声明的类型

2. 使用expr或let数值运算工具

   ```sh
   $(expr $a + $b)
   ```

   > $() : 是执行shell命令
   >
   > expr表达式表示运算表达式，运算符的两侧必须要有空格

3. 使用$(()) 或使用$[] 运算

   ```sh
   $(($a+$b))
   ```

   - 不推荐使用呢$[] , 因为中括号在shell中有特殊含义，在shell编程中容易混淆

### :anchor: shell常用运算符

1. 算术运算符

   > 假定变量 a 为 10，变量 b 为 20：

   | 运算符 | 说明                                          | 举例                          |
   | :----- | :-------------------------------------------- | :---------------------------- |
   | +      | 加法                                          | `expr $a + $b` 结果为 30。    |
   | -      | 减法                                          | `expr $a - $b` 结果为 -10。   |
   | *      | 乘法                                          | `expr $a \* $b` 结果为  200。 |
   | /      | 除法                                          | `expr $b / $a` 结果为 2。     |
   | %      | 取余                                          | `expr $b % $a` 结果为 0。     |
   | =      | 赋值                                          | a=$b 将把变量 b 的值赋给 a。  |
   | ==     | 相等。用于比较两个数字，相同则返回 true。     | [ $a == $b ] 返回 false。     |
   | !=     | 不相等。用于比较两个数字，不相同则返回 true。 | [ $a != $b ] 返回 true。      |

2. 关系运算符

   > 假定变量 a 为 10，变量 b 为 20：

   | 运算符 | 说明                                                  | 举例                       |
   | :----- | :---------------------------------------------------- | :------------------------- |
   | -eq    | 检测两个数是否相等，相等返回 true。                   | [ $a -eq $b ] 返回 false。 |
   | -ne    | 检测两个数是否不相等，不相等返回 true。               | [ $a -ne $b ] 返回 true。  |
   | -gt    | 检测左边的数是否大于右边的，如果是，则返回 true。     | [ $a -gt $b ] 返回 false。 |
   | -lt    | 检测左边的数是否小于右边的，如果是，则返回 true。     | [ $a -lt $b ] 返回 true。  |
   | -ge    | 检测左边的数是否大于等于右边的，如果是，则返回 true。 | [ $a -ge $b ] 返回 false。 |
   | -le    | 检测左边的数是否小于等于右边的，如果是，则返回 true。 | [ $a -le $b ] 返回 true。  |

3. 布尔运算符

   > 假定变量 a 为 10，变量 b 为 20：

   | 运算符 | 说明                                                | 举例                                     |
   | :----- | :-------------------------------------------------- | :--------------------------------------- |
   | !      | 非运算，表达式为 true 则返回 false，否则返回 true。 | [ ! false ] 返回 true。                  |
   | -o     | 或运算，有一个表达式为 true 则返回 true。           | [ $a -lt 20 -o $b -gt 100 ] 返回 true。  |
   | -a     | 与运算，两个表达式都为 true 才返回 true。           | [ $a -lt 20 -a $b -gt 100 ] 返回 false。 |

4. 逻辑运算符

   > 假定变量 a 为 10，变量 b 为 20:

   | 运算符 | 说明       | 举例                                       |
   | :----- | :--------- | :----------------------------------------- |
   | &&     | 逻辑的 AND | [[ $a -lt 100 && $b -gt 100 ]] 返回 false  |
   | \|\|   | 逻辑的 OR  | [[ $a -lt 100 \|\| $b -gt 100 ]] 返回 true |

5. 字符串运算符

   > 假定变量 a 为 "abc"，变量 b 为 "efg"：

   | 运算符 | 说明                                      | 举例                     |
   | :----- | :---------------------------------------- | :----------------------- |
   | =      | 检测两个字符串是否相等，相等返回 true。   | [ $a = $b ] 返回 false。 |
   | !=     | 检测两个字符串是否相等，不相等返回 true。 | [ $a != $b ] 返回 true。 |
   | -z     | 检测字符串长度是否为0，为0返回 true。     | [ -z $a ] 返回 false。   |
   | -n     | 检测字符串长度是否为0，不为0返回 true。   | [ -n "$a" ] 返回 true。  |
   | $      | 检测字符串是否为空，不为空返回 true。     | [ $a ] 返回 true。       |

6. 文件测试运算符

   | 操作符  | 说明                                                         | 举例                      |
   | :------ | :----------------------------------------------------------- | :------------------------ |
   | -b file | 检测文件是否是块设备文件，如果是，则返回 true。              | [ -b $file ] 返回 false。 |
   | -c file | 检测文件是否是字符设备文件，如果是，则返回 true。            | [ -c $file ] 返回 false。 |
   | -d file | 检测文件是否是目录，如果是，则返回 true。                    | [ -d $file ] 返回 false。 |
   | -f file | 检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。 | [ -f $file ] 返回 true。  |
   | -g file | 检测文件是否设置了 SGID 位，如果是，则返回 true。            | [ -g $file ] 返回 false。 |
   | -k file | 检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。  | [ -k $file ] 返回 false。 |
   | -p file | 检测文件是否是有名管道，如果是，则返回 true。                | [ -p $file ] 返回 false。 |
   | -u file | 检测文件是否设置了 SUID 位，如果是，则返回 true。            | [ -u $file ] 返回 false。 |
   | -r file | 检测文件是否可读，如果是，则返回 true。                      | [ -r $file ] 返回 true。  |
   | -w file | 检测文件是否可写，如果是，则返回 true。                      | [ -w $file ] 返回 true。  |
   | -x file | 检测文件是否可执行，如果是，则返回 true。                    | [ -x $file ] 返回 true。  |
   | -s file | 检测文件是否为空（文件大小是否大于0），不为空返回 true。     | [ -s $file ] 返回 true。  |
   | -e file | 检测文件（包括目录）是否存在，如果是，则返回 true。          | [ -e $file ] 返回 true。  |

### :anchor: shell测试



# 099_shell概述

- shell的应用场景 : 自己 或 团队使用, 重在功能的实现
  - shell要有Linux基础, 用于简化运维工作流程
- shell概述
  - shell名解释器, 让Linux内核可以看懂的一组Linux命令的文本文件
- /etc/shells : 查看当前系统支持的shell类型

# 100_echo

- echo输出文本最后一个字符是!   则后面需要加一个空格
- 输出命令 : 如果需要输出的有空格需要用引号
  - -e  选项 支持转义符  十六进制  或者 颜色和背景色

# 101_shell脚本执行方式

- 建议脚本用sh结尾
- shell脚本规范
  - `#!/bin/bash`  : bash bang - 用于表示该脚本shell类型
- shell 执行
  - 方式一 : 赋予脚本可执行权限, 绝对路径或相对路径执行脚本文件
  - 方式二 : `bash 脚本文件`   不需要文本的可执行权限

# 102_bash的基本功 - 103

- history 历史命令, 保存在 `~/.bash_history` 文件中   选项-c是清除  -w是将缓存中是命令写入到文件中,正确注销后也会添加到文件中,默认保存条数是1000, 在`etc/profile` .配置HISTSIZE = 1000, 
  - !! 重复上次命令   方向键向上反翻一条
  - !n   重复执行指定行号的历史
  - !字符串  : 重复最后一条以指定字符串执行的
  - !$  : 重复上一条命令的最后一个参数
- alias : 别名 : 别名文件保存在 `~/.bashrc` 文件中, 
  - 别名的优先级 : 绝对命令优先级高,  第二  如果命令有别名执行别名   第三是shell的内置命令   第四是$PATH环境变量的顺序的第一个命令
- source命令  配置文件    使坏境变量配置文件立即生效    `.`  也代表source
- bash 常用快捷键
  - `ctrl+a` 光标移动到命令开头
  - `ctrl+e` 光标移动到命令结尾
  - `ctrl+c` 终止命令
  - `ctrl+l` 清屏
  - `ctrl+u` 剪切光标之前的命令
  - `ctrl+k` 剪切光标之后的命令
  - `ctrl+y` 粘贴剪切板中的命令
  - `ctrl+r` 搜索
  - `ctrl+d` 退出当前终端
  - `ctrl+z` 暂停,并放入后台
  - `ctrl+s` 暂停屏幕输出
  - `ctrl+q` 恢复屏幕输出
- 输入输出重定向
